
<div class="p-5 bg-light min-vh-100">
  <header class="d-flex justify-content-between">
    <h1>{{ !payConfirmed ? 'Wybierz zapach' : 'ZapÅ‚aÄ‡' }}</h1>
    <button (click)="logout()">Logout</button>
  </header>

  <app-breadcrumbs 
  [showPaymentStep]="payConfirmed" (breadcrumbClick)="onBreadcrumbClick($event)"
></app-breadcrumbs>

  @if (!payConfirmed) {
    <div>
      <app-colognes-list (selectedCologne)="setCologneId($event)"></app-colognes-list>
    </div>
    @if (cologneId) {
      <footer class="d-flex justify-content-center align-items-center mt-5">
        <button (click)="confirmPayment()" class="w-50 p-4 rounded-4">
          <span>ZapÅ‚aÄ‡</span>
        </button>
      </footer>
    }
  } @else {
    <div class="d-flex flex-column justify-content-center align-items-center mt-5">
      
      <div class="discount-box mb-4 d-flex gap-2 w-75">
        <input 
          type="text"
          placeholder="Kod rabatowy"
          [(ngModel)]="discountCode"
          class="form-control"
        />
        <button (click)="applyDiscount()" class="btn btn-primary">
          Zastosuj
        </button>
      </div>
    
      <div *ngIf="discountPercent > 0" class="text-success mb-3">
        Zastosowano rabat: {{ discountPercent }}%
      </div>
    
      <p class="caption">Zeskanuj kod, aby zapÅ‚aciÄ‡</p>

      <div *ngIf="qrReady" class="text-center">
        
        <qrcode
          [qrdata]="qrData"
          [width]="250"
          [margin]="2"
          [errorCorrectionLevel]="'M'">
        </qrcode>

        <div class="mt-3 mb-3">
          <p class="small text-muted mb-1">Ile porcji zapachu?</p>
          
          <div class="d-flex justify-content-center align-items-center gap-2">
            
            <button (click)="decreaseQuantity()" class="btn btn-outline-secondary btn-sm" [disabled]="quantity <= 1">
              -
            </button>
            
            <span class="fs-5 fw-bold mx-2" style="min-width: 30px;">{{ quantity }}</span>
            
            <button (click)="increaseQuantity()" class="btn btn-outline-primary btn-sm" [disabled]="quantity >= 5">
              +
            </button>
          </div>
        </div>
    
        <div class="alert alert-info mt-3 py-2">
          <p class="mb-1"><small>ðŸ›  Tryb developerski:</small></p>
          <a [href]="qrData" target="_blank" class="btn btn-outline-primary btn-sm">
              ðŸ“² Kliknij, by otworzyÄ‡ "Telefon Klienta"
          </a>
        </div>
        
      </div>
    </div>
  }
</div>
