generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-1.1.x"]
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://postgres:cKJFLthYWMWMLXbvcyBZJCAdjygVwFkm@trolley.proxy.rlwy.net:20570/railway"
}

model Colognes {
  id           String           @id @default(uuid())
  cologne_name String
  brand_name   String           @default("unknown")
  orders       Orders[]
  image_url    String?
  @@map("colognes")
}

model Orders {
  id             String   @id @default(uuid())
  scent_id       String
  device_id      String   // ID urządzenia (Raspberry Pi), z którego przyszło zamówienie
  status         String   @default("PENDING") // Status: 'PENDING', 'PAID', 'FAILED'
  quantity       Int      @default(1)         // Ilość "psików" wybrana przez klienta
  amount         Decimal  @default(0.00)      // Kwota transakcji (dla celów księgowych)
  transaction_id String?                      // ID płatności z Tpay (opcjonalne, bo uzupełniane dopiero po powrocie z bramki)
  creation_date  DateTime @default(now())
  cologne        Colognes @relation(fields: [scent_id], references: [id])

  @@map("orders")
}
model Users {
  id            Int             @id @default(autoincrement())
  user_name     String @unique
  password      String
  role          Role            @default(CLIENT)
  device        Devices?        @relation(fields: [deviceId], references: [id])
  deviceId      Int?            @unique
  @@map("user")
}

model Devices {
  id          Int               @id @default(autoincrement())
  name        String
  location    String?
  scentSlots  Json
  user        Users?
  @@map("devices")
}

enum Role {
  ADMIN
  CLIENT
}